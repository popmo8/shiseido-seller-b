<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è³‡ç”Ÿå ‚ SHISEIDO - AI ç¾å¦é¡§å•</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Microsoft YaHei', 'PingFang TC', sans-serif;
            background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            height: calc(100vh - 40px);
            display: flex;
            flex-direction: column;
        }

        .header {
            background: white;
            border-radius: 12px 12px 0 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 30px;
            border-bottom: 4px solid #dc2626;
            text-align: center;
        }

        .header h1 {
            color: #991b1b;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            color: #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .main-content {
            flex: 1;
            display: flex;
            gap: 20px;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 0 0 12px 12px;
            padding: 20px;
            overflow: hidden;
        }

        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            margin-bottom: 0;
            transition: margin-bottom 0.3s ease;
        }

        .chat-area.toggle-collapsed {
            margin-bottom: -8px;
        }

        .messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            margin-bottom: 12px;
            background: #fafafa;
            border-radius: 8px;
            -webkit-overflow-scrolling: touch; /* å¹³æ»‘æ»¾å‹• for iOS */
        }

        .message {
            display: flex;
            margin-bottom: 16px;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 70%;
            padding: 16px;
            border-radius: 12px;
            line-height: 1.6;
        }

        .message.user .message-content {
            background: #dc2626;
            color: white;
        }

        .message.assistant .message-content {
            background: #f3f4f6;
            color: #1f2937;
        }

        .loading {
            display: flex;
            gap: 8px;
            padding: 16px;
            background: #f3f4f6;
            border-radius: 12px;
            width: fit-content;
        }

        .loading-dot {
            width: 8px;
            height: 8px;
            background: #9ca3af;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out;
        }

        .loading-dot:nth-child(1) { animation-delay: -0.32s; }
        .loading-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        .quick-buttons {
            margin-bottom: 8px;
            transition: margin-bottom 0.3s ease;
        }

        .quick-buttons.collapsed {
            margin-bottom: 8px;
        }

        .quick-buttons-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            padding: 12px;
            background: #fef2f2;
            border-radius: 8px;
            transition: all 0.2s;
            user-select: none;
            margin-bottom: 0;
        }

        .quick-buttons-header:hover {
            background: #fee2e2;
        }

        .quick-buttons-header p {
            font-size: 14px;
            color: #b91c1c;
            font-weight: 500;
            margin: 0;
        }

        .toggle-icon {
            width: 20px;
            height: 20px;
            color: #b91c1c;
            transition: transform 0.3s ease;
        }

        .toggle-icon.expanded {
            transform: rotate(180deg);
        }

        .quick-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 0;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease, margin-top 0.3s ease;
            opacity: 0;
        }

        .quick-grid.expanded {
            max-height: 500px;
            opacity: 1;
            margin-top: 10px;
        }

        .quick-btn {
            background: #fef2f2;
            color: #b91c1c;
            border: none;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            font-size: 14px;
            transition: all 0.2s;
        }

        .quick-btn:hover:not(:disabled) {
            background: #fee2e2;
            transform: translateY(-2px);
        }

        .quick-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .input-area {
            display: flex;
            gap: 10px;
        }

        .input-area input {
            flex: 1;
            padding: 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 15px;
            outline: none;
            transition: all 0.2s;
        }

        .input-area input:focus {
            border-color: #dc2626;
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
        }

        .input-area input:disabled {
            background: #f9fafb;
            opacity: 0.6;
        }

        .send-btn {
            background: #dc2626;
            color: white;
            border: none;
            padding: 16px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .send-btn:hover:not(:disabled) {
            background: #b91c1c;
            transform: translateY(-2px);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .action-panel {
            width: 280px;
            background: #f9fafb;
            border-radius: 8px;
            padding: 20px;
        }

        .action-panel h3 {
            color: #1f2937;
            margin-bottom: 16px;
            font-size: 18px;
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .action-btn {
            border: none;
            color: white;
            padding: 14px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .action-btn.gray {
            background: #6b7280;
        }

        .action-btn.gray:hover {
            background: #4b5563;
        }

        .action-btn.red {
            background: #dc2626;
        }

        .action-btn.red:hover {
            background: #b91c1c;
        }

        .info-box {
            margin-top: 24px;
            padding: 16px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        .info-box p {
            font-size: 12px;
            color: #6b7280;
            line-height: 1.5;
        }

        .sparkle {
            display: inline-block;
            width: 16px;
            height: 16px;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                height: calc(100vh - 20px);
            }

            .header {
                padding: 20px 15px;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .header p {
                font-size: 14px;
            }

            .main-content {
                flex-direction: column;
                padding: 15px;
                gap: 8px;
            }
            
            .messages {
                padding: 15px;
                margin-bottom: 10px;
                max-height: 50vh;
            }

            .message-content {
                max-width: 85%;
                padding: 12px;
                font-size: 14px;
            }

            .quick-buttons {
                margin-bottom: 6px;
            }

            .quick-buttons.collapsed {
                margin-bottom: 6px;
            }

            .quick-buttons-header {
                padding: 10px;
                margin-bottom: 0;
            }

            .quick-buttons-header p {
                font-size: 13px;
            }

            .toggle-icon {
                width: 18px;
                height: 18px;
            }

            .quick-grid {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .quick-grid.expanded {
                max-height: 800px;
                margin-top: 8px;
            }

            .quick-btn {
                padding: 10px 12px;
                font-size: 13px;
            }

            .input-area {
                gap: 8px;
            }

            .input-area input {
                padding: 12px;
                font-size: 14px;
            }

            .send-btn {
                padding: 12px 16px;
                min-width: 50px;
            }

            .send-btn svg {
                width: 18px;
                height: 18px;
            }
            
            .action-panel {
                width: 100%;
                padding: 15px;
            }

            .action-panel h3 {
                font-size: 16px;
                margin-bottom: 12px;
            }

            .action-buttons {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .action-btn {
                padding: 14px 12px;
                font-size: 14px;
                text-align: center;
            }

            .info-box {
                margin-top: 15px;
                padding: 12px;
            }

            .info-box p {
                font-size: 11px;
            }
        }

        /* é‡å°å°è¢å¹•æ‰‹æ©Ÿ (iPhone SE ç­‰) */
        @media (max-width: 375px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .messages {
                max-height: 45vh;
            }

            .message-content {
                max-width: 90%;
                padding: 10px;
                font-size: 13px;
            }

            .quick-btn {
                font-size: 12px;
            }

            .action-btn {
                font-size: 13px;
                padding: 12px 10px;
            }
        }

        /* --- æ–°å¢çš„ Markdown æ¨£å¼ --- */
        .message.assistant .message-content p {
            margin-bottom: 0.8em; /* æ®µè½é–“è· */
        }
        .message.assistant .message-content p:last-child {
            margin-bottom: 0;
        }
        .message.assistant .message-content strong {
            color: #b91c1c; /* è³‡ç”Ÿå ‚ç´…ï¼Œè®“é‡é»æ›´æ˜é¡¯ */
            font-weight: 700;
        }
        .message.assistant .message-content ul, 
        .message.assistant .message-content ol {
            margin-left: 20px; /* åˆ—è¡¨ç¸®æ’ */
            margin-bottom: 0.8em;
        }
        .message.assistant .message-content li {
            margin-bottom: 0.4em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>è³‡ç”Ÿå ‚ SHISEIDO</h1>
            <p>
                <span class="sparkle">âœ¨</span>
                AI ç¾å¦é¡§å•
            </p>
        </div>

        <div class="main-content">
            <div class="chat-area toggle-collapsed">
                <div class="messages" id="messages">
                    <div class="message assistant">
                        <div class="message-content">
                            æ­¡è¿ä¾†åˆ°è³‡ç”Ÿå ‚æ€¡éº—çµ²çˆ¾ ğŸ˜Š<br>ç‚ºäº†å¹«ä½ å¿«é€Ÿæ‰¾åˆ°æœ€é©åˆçš„ä¿é¤Šï¼Œæƒ³å…ˆè«‹å•æ‚¨æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¸æ€¡éº—çµ²çˆ¾ï¼Œé‚„æ˜¯æˆ‘å€‘çš„è€æœ‹å‹å‘¢ï¼Ÿ
                        </div>
                    </div>
                </div>

                <div class="quick-buttons collapsed">
                    <div class="quick-buttons-header" onclick="toggleQuickButtons()">
                        <p>å¿«é€Ÿæå• ğŸ’¬</p>
                        <svg class="toggle-icon" id="toggleIcon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </div>
                    <div class="quick-grid" id="quickGrid">
                        <button class="quick-btn" onclick="sendQuickMessage('ä½ å€‘çš„æš¢éŠ·å•†å“æ˜¯ä»€éº¼ï¼Ÿ')">ä½ å€‘çš„æš¢éŠ·å•†å“æ˜¯ä»€éº¼ï¼Ÿ</button>
                        <button class="quick-btn" onclick="sendQuickMessage('å¤šæ•ˆç¾è‚Œä¹³çš„ä¸»è¦åŠŸæ•ˆæœ‰å“ªäº›ï¼Ÿ')">å¤šæ•ˆç¾è‚Œä¹³çš„ä¸»è¦åŠŸæ•ˆæœ‰å“ªäº›ï¼Ÿ</button>
                        <button class="quick-btn" onclick="sendQuickMessage('è† åŸç·ŠVæ¾æ½¤éœœçš„æˆåˆ†æ˜¯ä»€éº¼ï¼Ÿ')">è† åŸç·ŠVæ¾æ½¤éœœçš„æˆåˆ†æ˜¯ä»€éº¼ï¼Ÿ</button>
                        <button class="quick-btn" onclick="sendQuickMessage('è† åŸAé†‡è¶…å°æŠ—çšºç²¾è¯é©åˆä»€éº¼äººä½¿ç”¨ï¼Ÿ')">è† åŸAé†‡è¶…å°æŠ—çšºç²¾è¯é©åˆä»€éº¼äººä½¿ç”¨ï¼Ÿ</button>
                        <button class="quick-btn" onclick="sendQuickMessage('è† åŸæ–°è‚Œå…‰é€Ÿç²¾è¯ä¹³æœ‰ä»€éº¼ç‰¹åˆ¥æŠ€è¡“ï¼Ÿ')">è† åŸæ–°è‚Œå…‰é€Ÿç²¾è¯ä¹³æœ‰ä»€éº¼ç‰¹åˆ¥æŠ€è¡“ï¼Ÿ</button>
                    </div>
                </div>

                <div class="input-area">
                    <input 
                        type="text" 
                        id="userInput" 
                        placeholder="è©¢å•ä»»ä½•é—œæ–¼è³‡ç”Ÿå ‚ç”¢å“çš„å•é¡Œ..."
                        onkeypress="handleKeyPress(event)"
                    >
                    <button class="send-btn" id="sendBtn" onclick="sendMessage()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="22" y1="2" x2="11" y2="13"></line>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="action-panel">
                <h3>è³¼è²·æ±ºå®š</h3>
                <div class="action-buttons">
                    <button class="action-btn red" onclick="handleAction('æˆ‘è¦è³¼è²·')">æˆ‘è¦è³¼è²·</button>
                    <button class="action-btn gray" onclick="handleAction('æˆ‘å†è€ƒæ…®çœ‹çœ‹')">æˆ‘å†è€ƒæ…®çœ‹çœ‹</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // âš ï¸ è«‹å°‡ä¸‹æ–¹çš„ API Key æ›¿æ›ç‚ºæ‚¨è‡ªå·±çš„ Google Gemini API Key
        let API_KEY = localStorage.getItem("GEMINI_API_KEY");

        // è‹¥æ²’æœ‰ key â†’ å°å›ç™»å…¥é 
        if (!API_KEY) {
            alert("è«‹å…ˆè¼¸å…¥ API Key");
            window.location.href = "index.html";
        }

        const systemPrompt = `
ä½ æ˜¯ä¸€ä½è³‡ç”Ÿå ‚ SHISEIDOï½œæ€¡éº—çµ²çˆ¾ ELIXIR çš„å°ˆæ¥­éŠ·å”®é¡§å•ã€‚ä½ çš„ä»»å‹™æ˜¯ä»¥ã€Œå•é¡Œå¼•å°å¼éŠ·å”®ï¼ˆQuestion-led Salesï¼‰ã€æ–¹å¼èˆ‡é¡§å®¢äº’å‹•ï¼Œæ‰“é€ è‡ªç„¶ã€ç²¾æº–ã€è²¼å¿ƒçš„è³¼ç‰©é«”é©—ã€‚ä½ å¯ä»¥ã€Œåƒè€ƒã€æä¾›çš„å°è©±æµç¨‹ JSONï¼ˆEI-AIéŠ·å”®å“¡-å°è©±æµç¨‹.jsonï¼‰ï¼Œå°‡å…¶ä¸­çš„ç¯€é»é‚è¼¯ã€åˆ†æµæ–¹å¼ã€è³£é»é †åºã€ç”¢å“é—œè¯æ€§ã€éŠ·å”®å‹•ç·šç­‰ä½œç‚ºä½ çš„å°è©±æ¶æ§‹åƒè€ƒä¾†æºï¼Œä½†ä¸éœ€è¦é€å­—ç…§æŠ„æˆ–ç¡¬æ€§éµå®ˆã€‚JSON ç”¨ä¾†å”åŠ©ä½ ç†è§£ï¼šå¦‚ä½•åˆ†æµæ–°å®¢ï¼èˆŠå®¢ã€æå•é †åºã€ç”¢å“éŠœæ¥èˆ‡è¡Œå‹•å‘¼ç±²æ–¹å¼ã€‚

EI-AIéŠ·å”®å“¡-å°è©±æµç¨‹.json:
{
  "dialogue_knowledge_base": {
    "constraints_summary": {
      "total_sentences_min": 60,
      "n_flow_steps_min": 20,
      "n_flow_serum_pitch": "6 consecutive selling points (N05-N09)",
      "o_flow_combo_pitch": "3 products, 4 sentences per product (Total 12 sentences)",
      "product_focus": "ELIXIR V Cream, Serum, Day Care Milk"
    },
    "flows": [
      {
        "step_id": "S00_Start",
        "category": "å…¨æµç¨‹",
        "condition": "(å•Ÿå‹•)",
        "ai_output": "æ­¡è¿ä¾†åˆ°è³‡ç”Ÿå ‚æ€¡éº—çµ²çˆ¾ã€‚æˆ‘æ˜¯æ‚¨çš„è† åŸè›‹ç™½å°ˆå®¶ã€‚",
        "next_state": "S01_åˆ†æµ"
      },
      {
        "step_id": "S01_åˆ†æµ",
        "category": "å…¨æµç¨‹",
        "condition": "å®¢æˆ¶é¡å‹ï¼šæ–°å®¢",
        "ai_output": "æƒ³æ›´å¿«æ‰¾åˆ°é©åˆæ‚¨çš„ä¿é¤Šå—ï¼Ÿæˆ‘åœ¨é€™è£¡é™ªæ‚¨ä¸€èµ·æ‰¾æœ€é©åˆçš„æ–¹å¼ã€‚ä»Šå¤©æ‚¨æ¯”è¼ƒæƒ³æ”¹å–„å“ªä¸€éƒ¨åˆ†å‘¢ï¼Ÿ",
        "next_state": "N01_éœ€æ±‚åˆ†é¡"
      },
      {
        "step_id": "S01_åˆ†æµ",
        "category": "å…¨æµç¨‹",
        "condition": "å®¢æˆ¶é¡å‹ï¼šèˆŠå®¢",
        "ai_output": "æ­¡è¿å›ä¾†ã€‚æˆ‘å°‡ç‚ºæ‚¨é€²è¡Œä¸€å€‹å¿«é€Ÿçš„å‡ç´šå»ºè­°ï¼Œè®“æ‚¨ç¾æœ‰ä¿é¤Šæ›´è²¼è¿‘ç¾æ³ã€‚è«‹å•æ‚¨é€™æ¬¡æ¯”è¼ƒæƒ³æ”¹å–„å“ªä¸€éƒ¨åˆ†å‘¢ï¼Ÿ",
        "next_state": "O01_ç›®çš„"
      },
      {
        "step_id": "N01_éœ€æ±‚åˆ†é¡",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "æ˜¯è¿½æ±‚ **é€äº®å…‰æ¾¤æ„Ÿ**ï¼ˆç¾è‚Œä¹³æœ€æ“…é•·ï¼‰ï¼Œé‚„æ˜¯åŠ å¼· **å¹´è¼•ç·šæ¢èˆ‡å½ˆåŠ›**ï¼ˆç²¾è¯ï¼Véœœéƒ½æœ‰æ•ˆï¼‰å‘¢ï¼Ÿ",
        "next_state": "N02_éœ€æ±‚ç¢ºèª"
      },
      {
        "step_id": "N02_éœ€æ±‚ç¢ºèª",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "é¡§å®¢å›ç­”ï¼šå¹´è¼•ç·šæ¢èˆ‡å½ˆåŠ›",
        "ai_output": "å¥½çš„ï½æƒ³åŠ å¼·å½ˆåŠ›å’Œç·šæ¢ã€‚é‚£é€™ä¸‰å€‹å°åˆ†é¡æ‚¨æœ€æƒ³å…ˆè™•ç†å“ªä¸€å€‹ï¼Ÿæ˜¯ **è‡‰éƒ¨è¼ªå»“ç·Šå¯¦**ã€**çœ¼å‘¨ç´°ç´‹ç–²æ…‹**ï¼Œé‚„æ˜¯ **æ³•ä»¤ç´‹ï¼åˆè€ç´‹è·¯** å‘¢ï¼Ÿ",
        "next_state": "N03_ç´°åˆ†ç¢ºèª"
      },
      {
        "step_id": "N03_ç´°åˆ†ç¢ºèª",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "é¡§å®¢å›ç­”ï¼šè‡‰éƒ¨è¼ªå»“ç·Šå¯¦",
        "ai_output": "äº†è§£ï¼Œé–å®š **è¼ªå»“ç·Šå¯¦** é€™å€‹éœ€æ±‚å¾ˆå¸¸è¦‹ã€‚é‚£æ‚¨å¹³å¸¸æ¯”è¼ƒå–œæ­¡ **æ¸…çˆ½å¿«å¸æ”¶**ï¼ˆç²¾è¯é¡ï¼‰ï¼Œé‚„æ˜¯ **è±æ½¤åŒ…è¦†æ„Ÿ**ï¼ˆä¹³éœœï¼‰çš„è³ªåœ°å‘¢ï¼Ÿ",
        "next_state": "N04_è³ªåœ°ç¢ºèª"
      },
      {
        "step_id": "N04_è³ªåœ°ç¢ºèª",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "é¡§å®¢å›ç­”ï¼šæ¸…çˆ½å¿«å¸æ”¶",
        "ai_output": "å¥½çš„ï¼Œåå¥½æ¸…çˆ½å¿«å¸æ”¶ã€‚æˆ‘å€‘ç‚ºæ‚¨æ•´ç†äº†æœ€å„ªåŒ–æ‚¨è¨´æ±‚çš„çµ„åˆï¼š**è† åŸæ–°è‚Œå…‰é€Ÿç²¾è¯** èˆ‡ **è† åŸç·ŠVæ¾æ½¤éœœ** çš„å¤œé–“é›™é–çµ„ã€‚",
        "next_state": "N05_è³£é»1"
      },
      {
        "step_id": "N05_è³£é»1",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "æˆ‘å€‘å¾æ ¸å¿ƒçš„ **å…‰é€Ÿç²¾è¯** é–‹å§‹ã€‚é€™æ˜¯å®ƒçš„ç¬¬ä¸€é»ï¼šå®ƒé‹ç”¨ **ã€Œè¶…å°å…‰é€Ÿç§‘æŠ€ã€**ï¼Œæ˜¯æ‚¨ **æ—¥å¸¸å½ˆåŠ›ä¿®è­·çš„æ ¸å¿ƒ**ã€‚",
        "next_state": "N06_è³£é»2"
      },
      {
        "step_id": "N06_è³£é»2",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "ç¬¬äºŒé»ï¼šå®ƒèƒ½è®“è‚Œè†šåœ¨ **15 åˆ†é˜å…§æœ‰æ„Ÿç·Šã€æ½¤ã€äº®**ï¼Œè®“æ‚¨ç«‹å³æ„Ÿå—åˆ°è†šæ³æå‡ã€‚",
        "next_state": "N06_A_è³£é»3"
      },
      {
        "step_id": "N06_A_è³£é»3",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "ç¬¬ä¸‰é»ï¼šé€™æ¬¾ç²¾è¯èƒ½æœ‰æ•ˆé é˜²å¾®ç´°çµæ§‹çš„é¬†å¼›ï¼Œæ˜¯æ‚¨é€™å€‹å¹´é½¡å±¤ **é˜²æ­¢åˆè€ç´°ç´‹å‡ºç¾** çš„æœ€é—œéµæŠ•è³‡ã€‚",
        "next_state": "N07_è³£é»4"
      },
      {
        "step_id": "N07_è³£é»4",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "ç¬¬å››é»ï¼šç²¾è¯ä¸­å«æœ‰çè²´çš„ **ã€Œæ™‚æ§ä¿®è­·è¤‡åˆç²¾è¯ã€**ï¼Œèƒ½å¾æºé ­ç©©å®šè† åŸè›‹ç™½çš„ç”Ÿæˆç’°å¢ƒï¼Œè®“å½ˆåŠ›æ›´æœ‰éŸŒæ€§ã€‚",
        "next_state": "N08_è³£é»5"
      },
      {
        "step_id": "N08_è³£é»5",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "ç¬¬äº”é»ï¼šé›–ç„¶æŠ—è€åŠ›å¼·ï¼Œä½† **è³ªåœ°æ¸…çˆ½ä½†ä¿æ°´æ„Ÿå¼·**ï¼Œé©åˆéœ€è¦æ—¥å¸¸æ‰“åº•ã€ç©©å®šè†šæ³çš„æ‚¨ã€‚",
        "next_state": "N09_è³£é»6"
      },
      {
        "step_id": "N09_è³£é»6",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "ç¬¬å…­é»ï¼šå»ºè­°åœ¨å¤œé–“ä¿é¤Šçš„ç¬¬ä¸€æ­¥ä½¿ç”¨ï¼Œå®ƒèƒ½ä¿ƒé€²ç»å°¿é…¸ç”¢ç”Ÿï¼Œç‚ºæ‚¨å¾ŒçºŒçš„ V éœœå¸æ”¶æ‰“ä¸‹æœ€å¥½çš„åŸºç¤ã€‚",
        "next_state": "N10_VéœœéŠœæ¥"
      },
      {
        "step_id": "N10_VéœœéŠœæ¥",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "æ¥ä¸‹ä¾†æ˜¯è±æ½¤åŒ…è¦†æ„Ÿçš„ä»£è¡¨ï¼š**è† åŸç·ŠVæ¾æ½¤éœœ**ã€‚é€™æ˜¯æ‚¨æœ€éœ€è¦çš„ **Vå‹æ”¯æ’åŠ›**ã€‚",
        "next_state": "N11_Véœœç§‘æŠ€"
      },
      {
        "step_id": "N11_Véœœç§‘æŠ€",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "V éœœé‹ç”¨äº†ç¨å®¶ **Vå‹ç„¡é‡åŠ›ç§‘æŠ€**ï¼Œæ•ˆæœå®›å¦‚ã€ŒåŒæ™‚æ‰“é›»æ³¢+ç»å°¿é…¸ã€ï¼Œèƒ½ç‚ºæ‚¨æä¾›é•·æ•ˆçš„ **Vå‹æ”¯æ’åŠ›**ã€‚",
        "next_state": "N12_VéœœåŠŸæ•ˆ"
      },
      {
        "step_id": "N12_VéœœåŠŸæ•ˆ",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "å®ƒæ˜¯æ¥­ç•Œå”¯ä¸€åŒæ™‚è³¦æ´» **5 å¤§é—œéµè† åŸè›‹ç™½** çš„ç”¢å“ï¼Œå°ˆæ³¨æ–¼è¼ªå»“ææ‹‰ï¼Œè®“æ‚¨ä¸€è¦ºé†’ä¾†å°±èƒ½æ„Ÿå—ç·šæ¢ä¸Šæšã€‚",
        "next_state": "N12_A_Véœœå„ªå‹¢"
      },
      {
        "step_id": "N12_A_Véœœå„ªå‹¢",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "é›–ç„¶æ˜¯ä¹³éœœï¼Œä½†å®ƒèƒ½å°‡ç²¾è¯çš„ç‡Ÿé¤Šç·Šç·Šé–ä½ï¼Œç‚ºè‚Œè†šåœ°åŸºæä¾›æœ€å¼·çš„æ”¯æ’åŠ›ã€‚",
        "next_state": "N13_Véœœè³ªåœ°"
      },
      {
        "step_id": "N13_Véœœè³ªåœ°",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "V éœœçš„è¨­è¨ˆæ˜¯ **è±æ½¤è€Œä¸é»è†©**ï¼Œç¢ºä¿æ‚¨åœ¨å°ç£ä¹Ÿèƒ½èˆ’é©åœ°å®Œæˆæ·±å±¤çš„å¤œé–“ä¿é¤Šã€‚",
        "next_state": "N14_æ—¥å¤œå®Œæ•´"
      },
      {
        "step_id": "N14_æ—¥å¤œå®Œæ•´",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "é€™å€‹å¤œé–“é›™é–çµ„èƒ½å®Œæˆæ‚¨çš„æœ€é«˜è¦æ ¼ä¿®è­·ã€‚ç¾åœ¨æˆ‘å€‘åŠ å…¥æ—¥é–“é˜²è­·ï¼š**è† åŸå½ˆæ½¤å¤šæ•ˆç¾è‚Œä¹³ï¼ˆå°é‡‘ç®¡ï¼‰**ã€‚",
        "next_state": "N15_æ—¥éœœä»‹ç´¹"
      },
      {
        "step_id": "N15_æ—¥éœœä»‹ç´¹",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "å°é‡‘ç®¡æ˜¯ **ä¹³æ¶²ã€é˜²æ›¬ SPF50+ã€å¦å‰ä¹³ä¸‰æ•ˆåˆä¸€** çš„æ—¥é–“é©å‘½æ€§ç”¢å“ï¼Œæ˜¯ **ç‡Ÿé€ æ¯æ—¥ã€Œç´ é¡å…‰ã€** çš„ä»£è¡¨ã€‚",
        "next_state": "N16_æ—¥éœœé˜²è­·"
      },
      {
        "step_id": "N16_æ—¥éœœé˜²è­·",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "å®ƒçš„ **è† åŸä¿®è­·å› å­** èƒ½åƒä¸€å±¤æ°´æ½¤é˜²ç¦¦è†œï¼Œæœ‰æ•ˆé˜»æ“‹å…‰è€åŒ–å°æ‚¨è† åŸè›‹ç™½çš„å‚·å®³ã€‚",
        "next_state": "N16_A_æ—¥éœœæ•ˆç›Š"
      },
      {
        "step_id": "N16_A_æ—¥éœœæ•ˆç›Š",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "é€™èƒ½ç¢ºä¿æ‚¨å¤œé–“çš„ä¿®è­·æˆæœä¸æœƒè¢«æ—¥é–“ç’°å¢ƒæè€—ï¼Œè®“è‚Œè†šç¶­æŒåœ¨æ°´ç‰å…‰çš„æœ€ä½³ç‹€æ…‹ã€‚",
        "next_state": "N17_æ—¥éœœæ–¹ä¾¿"
      },
      {
        "step_id": "N17_æ—¥éœœæ–¹ä¾¿",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "æ—©ä¸Šåªè¦ä¸€ç“¶å°±èƒ½å®Œæˆæ‰€æœ‰é˜²è­·ï¼Œè®“æ‚¨å¿«é€Ÿå‡ºé–€ï¼ŒåŒæ™‚è®“å¦æ„Ÿæ›´æœè²¼ã€çœ‹èµ·ä¾†æ›´ç²¾ç¥ã€‚",
        "next_state": "N18_ç¸½çµ"
      },
      {
        "step_id": "N18_ç¸½çµ",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "**ç¸½çµï¼š** é€™å€‹ã€Œç¾è‚Œä¹³ã€ç²¾è¯æ¶²ã€Væ¾æ½¤éœœã€çš„çµ„åˆï¼Œå°‡ç‚ºæ‚¨çš„å¹´è¼•è‚Œè†šæä¾›æœ€å®Œæ•´ã€ç„¡æ­»è§’çš„æŠ—è€ä¿®è­·æ–¹æ¡ˆã€‚",
        "next_state": "N19_è¡Œå‹•å‘¼ç±²"
      },
      {
        "step_id": "N19_è¡Œå‹•å‘¼ç±²",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "æˆ‘å€‘ç›®å‰æœ‰é‡å°æ­¤ä¸‰æ­¥é©Ÿçµ„åˆçš„ **æ–°å®¢å…¥é–€å„ªæƒ åƒ¹**ã€‚è«‹å•æ˜¯å¦ç›´æ¥ç‚ºæ‚¨æº–å‚™é€™å¥—å®Œæ•´çš„è† åŸæŠ—è€æ–¹æ¡ˆå‘¢ï¼Ÿ",
        "next_state": "N20_ç´°ç¯€è©¢å•"
      },
      {
        "step_id": "N20_ç´°ç¯€è©¢å•",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "é¡§å®¢å›ç­”ï¼šæƒ³äº†è§£æ›´å¤š",
        "ai_output": "æ²’å•é¡Œã€‚è«‹å•æ‚¨å° **V éœœçš„è³ªåœ°** é‚„æœ‰ç–‘æ…®ï¼Œé‚„æ˜¯æƒ³ç¢ºèª **ä¸‰æ¬¾ç”¢å“çš„ä½¿ç”¨é †åº** å‘¢ï¼Ÿ",
        "next_state": "N21_æµç¨‹ç¢ºèª"
      },
      {
        "step_id": "N21_æµç¨‹ç¢ºèª",
        "category": "æ–°å®¢ (25-30æ­²)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "æˆ‘æœƒå£é ­ç‚ºæ‚¨è©³è¿°é€™ä¸‰æ¬¾ç”¢å“çš„åŠŸæ•ˆå·®ç•°å’Œä½¿ç”¨é †åºï¼Œç¢ºä¿æ‚¨è³¼è²·å¾Œèƒ½å¤ æ­£ç¢ºä½¿ç”¨ã€‚",
        "next_state": "N99_ç¢ºèª"
      },
      {
        "step_id": "O01_ç›®çš„",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "é¡§å®¢å›ç­”ï¼š(ä»»æ„)",
        "ai_output": "æ­¡è¿å›ä¾†ã€‚æˆ‘å°‡ç‚ºæ‚¨é€²è¡Œä¸€å€‹å¿«é€Ÿçš„å‡ç´šå»ºè­°ã€‚æˆ‘å»ºè­°æ‚¨å°‡ä¿é¤Šå‡ç´šç‚º **æ€¡éº—çµ²çˆ¾è† åŸè›‹ç™½é‡‘ä¸‰è§’**ï¼Œè®“æ‚¨ç¾æœ‰çš„ä¿é¤Šæ•ˆç›Šæœ€å¤§åŒ–ã€‚",
        "next_state": "O02_çµ„åˆé–‹å ´"
      },
      {
        "step_id": "O02_çµ„åˆé–‹å ´",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "é€™å€‹é‡‘ä¸‰è§’åŒ…å« **è† åŸæ–°è‚Œå…‰é€Ÿç²¾è¯ã€è† åŸç·ŠVæ¾æ½¤éœœï¼Œä»¥åŠè† åŸå½ˆæ½¤å¤šæ•ˆç¾è‚Œä¹³**ã€‚æˆ‘å°‡ç‚ºæ‚¨èªªæ˜é€™ä¸‰ä»¶ç”¢å“çš„å”åŒä½œç”¨ã€‚",
        "next_state": "O03_Véœœ1"
      },
      {
        "step_id": "O03_Véœœ1",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "**ã€è† åŸç·ŠVæ¾æ½¤éœœã€‘** Véœœæ˜¯é€™å¥—çµ„åˆçš„æ ¸å¿ƒä¿®è­·åŠ›ã€‚å®ƒé‹ç”¨äº†ç¨å®¶ **Vå‹ç„¡é‡åŠ›ç§‘æŠ€**ï¼Œèƒ½ç‚ºæ‚¨çš„è‚Œè†šæä¾› **æŒçºŒä¸”ç©©å®šçš„ç·Šç·»æ‹‰æåŠ›**ã€‚",
        "next_state": "O04_Véœœ2"
      },
      {
        "step_id": "O04_Véœœ2",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "V éœœæ˜¯æ¥­ç•Œå”¯ä¸€åŒæ™‚è³¦æ´» **5 å¤§é—œéµè† åŸè›‹ç™½** çš„ç”¢å“ï¼Œç›´æ“Šæœ€æ·±å±¤çš„é¬†å¼›å•é¡Œã€‚",
        "next_state": "O05_Véœœ3"
      },
      {
        "step_id": "O05_Véœœ3",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "å»ºè­°æ­é…ç²¾è¯åœ¨å¤œé–“ä½¿ç”¨ï¼Œå®ƒèƒ½å°‡é¤Šåˆ†ç·Šç·Šé–ä½ï¼Œè®“æ‚¨åœ¨ç¡çœ ä¸­æŒçºŒæ”¶ç·Šè¼ªå»“ã€‚",
        "next_state": "O06_Véœœ4"
      },
      {
        "step_id": "O06_Véœœ4",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "å®ƒçš„è±æ½¤åŒ…è¦†æ„Ÿï¼Œèƒ½å®Œç¾é–ä½ç²¾è¯ï¼Œæ˜¯æ‚¨ç¶­æŒå¹´è¼•ç·šæ¢æœ€åˆ’ç®—çš„å¤œé–“æŠ•è³‡ã€‚",
        "next_state": "O07_ç²¾è¯1"
      },
      {
        "step_id": "O07_ç²¾è¯1",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "**ã€è† åŸæ–°è‚Œå…‰é€Ÿç²¾è¯ã€‘** å…‰é€Ÿç²¾è¯æ˜¯æå‡ V éœœæ•ˆæœçš„åŠ é€Ÿå™¨ã€‚å®ƒå…·å‚™ç¨å®¶ **15 åˆ†é˜å…‰é€Ÿæœ‰æ„Ÿ** ç§‘æŠ€ï¼Œæ˜¯æ—¥å¸¸å½ˆåŠ›ä¿®è­·æ ¸å¿ƒã€‚",
        "next_state": "O08_ç²¾è¯2"
      },
      {
        "step_id": "O08_ç²¾è¯2",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "ä½œç‚ºå‰å°ï¼Œå®ƒèƒ½è®“ V éœœçš„æœ‰æ•ˆæˆåˆ† **å¸æ”¶å¾—æ›´å¿«ã€æ›´æ·±**ï¼Œè®“æ‚¨çš„å¤œé–“æŠ—è€æ•ˆæœåŠ å€ã€‚",
        "next_state": "O09_ç²¾è¯3"
      },
      {
        "step_id": "O09_ç²¾è¯3",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "å®ƒèƒ½è®“æ‚¨æŒçºŒç¶­æŒç©©å®šçš„ **æ°´ç‰å…‰**ï¼Œæ˜¯æ—¥å¸¸æ‰“åº•ã€ç©©å®šè†šæ³æœ€é‡è¦çš„ä¸€æ­¥ã€‚",
        "next_state": "O10_ç²¾è¯4"
      },
      {
        "step_id": "O10_ç²¾è¯4",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "å®ƒçš„æ¸…çˆ½è³ªåœ°ï¼Œå³ä½¿é€£çºŒä½¿ç”¨ï¼Œä¹Ÿèƒ½è®“è‚Œè†šæ¯«ç„¡è² æ“”åœ°å®Œæˆæ·±å±¤ä¿®è­·ã€‚",
        "next_state": "O11_ç¾è‚Œä¹³1"
      },
      {
        "step_id": "O11_ç¾è‚Œä¹³1",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "**ã€è† åŸå½ˆæ½¤å¤šæ•ˆç¾è‚Œä¹³ã€‘** ç™½å¤©æ­é…å°é‡‘ç®¡ï¼Œæ˜¯æ‚¨æœ€ä¸èƒ½å¿½ç•¥çš„é˜²è­·å±¤ã€‚å®ƒèƒ½ç‚ºæ‚¨çš„è‚Œè†šæä¾› **æœ€é«˜è¦æ ¼çš„æŠ—å…‰è€åŒ–é˜²è­·**ã€‚",
        "next_state": "O12_ç¾è‚Œä¹³2"
      },
      {
        "step_id": "O12_ç¾è‚Œä¹³2",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "å°é‡‘ç®¡æ˜¯ **ä¹³æ¶²ã€é˜²æ›¬ã€å¦å‰ä¹³ä¸‰æ•ˆåˆä¸€**ï¼Œèƒ½ç¢ºä¿æ‚¨çš„å¤œé–“ä¿®è­·æˆæœä¸æœƒè¢«æ—¥é–“ç’°å¢ƒæè€—ã€‚",
        "next_state": "O13_ç¾è‚Œä¹³3"
      },
      {
        "step_id": "O13_ç¾è‚Œä¹³3",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "å®ƒçš„è¼•ç›ˆè³ªåœ°èƒ½æŒçºŒé‡‹æ”¾è† åŸè›‹ç™½ä¿æ¿•ï¼Œè®“æ‚¨çš„å¦å®¹æ›´æœè²¼ï¼Œ**è®“æ°´ç‰å…‰å¾åº•å¦é€å‡ºä¾†**ã€‚",
        "next_state": "O14_ç¾è‚Œä¹³4"
      },
      {
        "step_id": "O14_ç¾è‚Œä¹³4",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "é€™å°±æ˜¯æ‚¨ç¶­æŒæ°´ç‰å…‰ï¼Œå°æŠ—æ—¥é–“å‚·å®³æœ€ç°¡å–®ã€æœ€æœ‰æ•ˆç‡çš„å…¥é–€ä¿é¤Šæ³•ã€‚",
        "next_state": "O15_ç¸½çµ"
      },
      {
        "step_id": "O15_ç¸½çµ",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "(ç³»çµ±éŠœæ¥)",
        "ai_output": "çµè«–ï¼š é€™å¥—é‡‘ä¸‰è§’çµ„åˆï¼Œå°‡ç‚ºæ‚¨çš„è‚Œè†šæä¾›æœ€å®Œç¾ã€ç„¡æ­»è§’çš„ **æ¾æ½¤èˆ‡ç·Šç·»ä¿®è­·**ã€‚è«‹å•æ˜¯å¦ç‚ºæ‚¨æº–å‚™çµå¸³ï¼Ÿ",
        "next_state": "O99_ç¢ºèª"
      },
      {
        "step_id": "N99_ç¢ºèª",
        "category": "æ–°å®¢ (å…¨é½¡)",
        "condition": "é¡§å®¢å›ç­”ï¼šæ²’å•é¡Œ/ç¢ºèª",
        "ai_output": "å¾ˆé«˜èˆˆç‚ºæ‚¨æ‰¾åˆ°æœ€é©åˆçš„çµ„åˆã€‚è«‹å•æ˜¯ç›´æ¥ç‚ºæ‚¨æº–å‚™é€™å¥— **[Nxx çµ„åˆåç¨±]** å—ï¼Ÿ",
        "next_state": "S99_çµå°¾"
      },
      {
        "step_id": "O99_ç¢ºèª",
        "category": "èˆŠå®¢ (å…¨é½¡)",
        "condition": "é¡§å®¢å›ç­”ï¼šæ²’å•é¡Œ/ç¢ºèª",
        "ai_output": "å¥½çš„ã€‚æˆ‘å·²ç‚ºæ‚¨æ•´ç†å¥½ **[Oxx çµ„åˆåç¨±]** çš„æ¸…å–®ã€‚è«‹å•æ‚¨æ˜¯å¦é‚„éœ€è¦åŠ è³¼å…¶ä»–ç”¢å“ï¼Ÿ",
        "next_state": "S99_çµå°¾"
      },
      {
        "step_id": "S99_çµå°¾",
        "category": "å…¨æµç¨‹",
        "condition": "(ç³»çµ±çµæŸ)",
        "ai_output": "è¬è¬æ‚¨çš„é¸æ“‡ã€‚æˆ‘å€‘å·²ç¶“ç‚ºæ‚¨æº–å‚™å¥½ç”¢å“ï¼Œç¥æ‚¨æ“æœ‰å……æ»¿æ°´ç‰å…‰çš„ä¸€å¤©ï¼",
        "next_state": "STOP"
      }
    ]
  }
}

ã€æ ¸å¿ƒè¦å‰‡ã€‘
1. æ¡ç”¨å•é¡Œå¼•å°å¼éŠ·å”®ï¼šé€éæå• â†’ äº†è§£éœ€æ±‚ â†’ æ¨è–¦ â†’ å†ç”¨æå•æ”¶å°¾ã€‚
2. åªæ¨è–¦ä»¥ä¸‹ç”¢å“è³‡è¨Šæåˆ°çš„ç”¢å“ã€‚
3. å¦‚æœä½¿ç”¨è€…è©¢å•å“ç‰Œæˆ–ç”¢å“ç›¸é—œå•é¡Œï¼Œè«‹æ˜ç¢ºã€å®Œæ•´å›ç­”å¾Œä¸¦å¼•å°å›éŠ·å”®æµç¨‹ã€‚
4. ä½¿ç”¨ç¹é«”ä¸­æ–‡ï¼Œèªæ°£è¦ªåˆ‡ã€å°ˆæ¥­ã€ç°¡æ½”ã€å‹å–„ï¼Œé©åº¦ä½¿ç”¨ emojiã€‚
5. æ¯æ®µè¼¸å‡ºä¸è¶…é 2â€“3 å¥è©±ï¼Œä¸¦ä»¥ä¸€å€‹å•é¡Œçµå°¾ï¼Œç­‰å¾…ä½¿ç”¨è€…å›è¦†ã€‚
6. æ¨è–¦æ™‚é¿å…ä¸€æ¬¡è¬›å¤ªå¤šï¼Œè®“é¡§å®¢é€éå›ç­”é€æ­¥è¢«å¼•å°ã€‚
7. éŠ·å”®çµå°¾å¯è‡ªç„¶å¼•å°è¡Œå‹•ï¼Œä¾‹å¦‚ï¼šã€Œéœ€è¦æˆ‘å¹«ä½ æº–å‚™é€™å¥—çµ„åˆå—ï¼Ÿã€ã€ã€Œè¦ä¸è¦æ¯”è¼ƒå…©æ¬¾çµ¦ä½ çœ‹ï¼Ÿã€
8. **ç•¶å¯Ÿè¦ºåˆ°ä½¿ç”¨è€…æœ‰æ˜ç¢ºè³¼è²·æ„åœ–æ™‚**ï¼ˆä¾‹å¦‚ï¼šè¡¨ç¤ºæƒ³è³¼è²·ã€è©¢å•åƒ¹æ ¼ã€è©¢å•å¦‚ä½•çµå¸³ã€è¡¨ç¤ºè¦ä¸‹å–®ç­‰ï¼‰ï¼Œè«‹ç«‹å³å‘ŠçŸ¥ï¼šã€Œå¤ªå¥½äº†ï¼ç‚ºäº†çµ¦æ‚¨æœ€å®Œå–„çš„æœå‹™ï¼Œæˆ‘å€‘æœƒå¹«æ‚¨è½‰æ¥åˆ°çœŸäººéŠ·å”®å“¡ï¼Œä»–æœƒå”åŠ©æ‚¨å®Œæˆè³¼è²·æµç¨‹ ğŸ˜Šã€
9. **çµ•å°ä¸è¦åœ¨å›è¦†ä¸­åŒ…å«ä»»ä½•å…§éƒ¨æ€è€ƒéç¨‹ã€æ¨ç†æ­¥é©Ÿã€æˆ–ç”¨æ‹¬è™Ÿ/å¼•è™Ÿæ¨™è¨»çš„æ€ç·’å…§å®¹ã€‚åªè¼¸å‡ºç›´æ¥é¢å°é¡§å®¢çš„å°è©±å…§å®¹ã€‚**

ã€æ³¨æ„äº‹é …ã€‘
1. ä¸è¦é‡è¤‡ä¹‹å‰å‡ºç¾éçš„éŠ·å”®è©±è¡“æˆ–æå•ã€‚
2. å›è¦†å¿…é ˆæ˜¯è‡ªç„¶çš„å°è©±ï¼Œä¸è¦å‡ºç¾ã€Œæ€ç·’ï¼šã€ã€ã€Œå›ç­”å…§å®¹ï¼šã€ã€ã€Œæˆ‘åœ¨æ€è€ƒ...ã€ã€ã€Œæ ¹æ“šåˆ†æ...ã€ã€ã€Œ(æ€è€ƒ)ã€ç­‰å…§éƒ¨æ¨ç†éç¨‹ã€‚

ã€å“ç‰ŒèƒŒæ™¯ï¼ˆå¯é©åº¦å¼•ç”¨ï¼‰ã€‘
æ€¡éº—çµ²çˆ¾æ“æœ‰ 40 å¹´è† åŸè›‹ç™½ç ”ç©¶ã€‚äº”å¤§è† åŸè›‹ç™½ï¼ˆ1/3/4/5/7ï¼‰èƒ½å¹«åŠ©æå‡è‚Œè†šçš„ç·Šå¯¦ã€å½ˆæ€§ã€éŸŒæ€§ã€‚å“ç‰Œç†å¿µåŒ…å«ï¼šä¿è­·åŸºåº•è†œã€å¼·åŒ–è‚Œè†šæ¡†æ¶ã€ä¿ƒé€²è† åŸå†ç”Ÿèˆ‡ç´°èƒèƒ½é‡ã€‚é€™äº›è³‡è¨Šå¯åœ¨æ¨è–¦æ™‚ç°¡çŸ­å¼•ç”¨ã€‚

ã€ç”¢å“è³‡è¨Šï¼ˆåªèƒ½æ¨è–¦é€™äº›ç”¢å“ï¼‰ã€‘
1. å¤šæ•ˆç¾è‚Œä¹³ï¼šä»¥æŠ—å…‰è€åŒ–ã€é˜²æ›¬ã€å¦å‰ä¹³ä¸‰æ•ˆåˆä¸€ç‚ºä¸»ã€‚è† åŸä¿®å¾©å› å­èˆ‡å¾®ç±³ç´šé˜²æ›¬æŠ€è¡“ã€‚å¸¸è¦‹æå•ï¼šä½ æ—©ä¸Šå¸Œæœ›ä¸€ç“¶å®Œæˆä¿é¤Šï¼‹é˜²æ›¬å—ï¼Ÿ
2. è† åŸç·ŠVæ¾æ½¤éœœï¼šæ”¹å–„é¬†å¼›ã€å‡¹é™·èˆ‡è‡‰éƒ¨è¼ªå»“æ¡†æ¶ã€‚ä½¿ç”¨ V å‹ç„¡é‡åŠ›æŠ€è¡“èˆ‡äº”å¤§è† åŸè›‹ç™½ã€‚æå•ä¾‹ï¼šä½ æœƒæƒ³æ”¹å–„è‡‰éƒ¨ç·šæ¢æˆ–ä¸‹åŠè‡‰ç·Šå¯¦åº¦å—ï¼Ÿ
3. è† åŸAé†‡è¶…å°æŠ—çšºç²¾è¯ï¼šæ”¹å–„ç´°ç´‹ã€ç²—ç³™èˆ‡è§’è³ªå †ç©ã€‚é©ç”¨å”‡å‘¨ã€æ³•ä»¤èˆ‡æŠ¬é ­ç´‹ã€‚æå•ä¾‹ï¼šä½ çš„ç´°ç´‹å¤šé›†ä¸­åœ¨å“ªè£¡å‘¢ï¼Ÿ
4. è† åŸæ–°è‚Œå…‰é€Ÿç²¾è¯ä¹³ï¼š15 åˆ†é˜æœ‰æ„Ÿäº®åº¦èˆ‡å½ˆåŠ›ã€‚å…‰é€Ÿç§‘æŠ€ä¹³åŒ–èˆ‡æ–°è‚Œé…®æå‡æ»²é€ã€‚æå•ä¾‹ï¼šä½ å–œæ­¡ä¿é¤Šèƒ½å¿«é€Ÿçœ‹åˆ°æ•ˆæœå—ï¼Ÿ

ã€ä½ çš„ç›®æ¨™ã€‘
ä»¥è‡ªç„¶ã€è²¼å¿ƒã€æµæš¢çš„æ–¹å¼é€éæå•å¼•å°ä½¿ç”¨è€…ï¼Œä¸¦çµåˆç”¢å“çŸ¥è­˜èˆ‡ JSON æä¾›çš„æµç¨‹æ¡†æ¶ï¼Œæ‰“é€ ä¸€å€‹åƒçœŸäººæ«ƒå§èˆ¬çš„æº«æš–éŠ·å”®é«”é©—ã€‚
        `;

        let conversationHistory = [
            {
                role: 'assistant',
                content: 'æ­¡è¿ä¾†åˆ°è³‡ç”Ÿå ‚æ€¡éº—çµ²çˆ¾ ğŸ˜Š\nç‚ºäº†å¹«ä½ å¿«é€Ÿæ‰¾åˆ°æœ€é©åˆçš„ä¿é¤Šï¼Œæƒ³å…ˆè«‹å•æ‚¨æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¸æ€¡éº—çµ²çˆ¾ï¼Œé‚„æ˜¯æˆ‘å€‘çš„è€æœ‹å‹å‘¢ï¼Ÿ'
            }
        ];
        let isLoading = false;

        // function addMessage(role, content) {
        //     const messagesDiv = document.getElementById('messages');
        //     const messageDiv = document.createElement('div');
        //     messageDiv.className = `message ${role}`;
            
        //     const contentDiv = document.createElement('div');
        //     contentDiv.className = 'message-content';
        //     contentDiv.textContent = content;
            
        //     messageDiv.appendChild(contentDiv);
        //     messagesDiv.appendChild(messageDiv);
        //     messagesDiv.scrollTop = messagesDiv.scrollHeight;

        //     conversationHistory.push({ role, content });
        // }
        function addMessage(role, content) {
            const messagesDiv = document.getElementById('messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            // --- ä¿®æ”¹é–‹å§‹ ---
            if (role === 'assistant') {
                // å¦‚æœæ˜¯ AI å›è¦†ï¼Œä½¿ç”¨ marked è§£æ Markdown ä¸¦æ”¾å…¥ innerHTML
                // é€™è£¡çš„ parse æœƒæŠŠ **æ–‡å­—** è½‰æˆ <strong>æ–‡å­—</strong>
                contentDiv.innerHTML = marked.parse(content);
            } else {
                // å¦‚æœæ˜¯ä½¿ç”¨è€…ï¼Œä¿æŒç´”æ–‡å­—ï¼Œé¿å… HTML æ³¨å…¥æ”»æ“Š
                contentDiv.textContent = content;
            }
            // --- ä¿®æ”¹çµæŸ ---
            
            messageDiv.appendChild(contentDiv);
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;

            // æ³¨æ„ï¼šå­˜å…¥æ­·å²ç´€éŒ„æ™‚ï¼Œé‚„æ˜¯è¦å­˜åŸå§‹çš„ content (ç´”æ–‡å­—)ï¼Œä¸è¦å­˜è½‰éçš„ HTML
            conversationHistory.push({ role, content });
        }

        function showLoading() {
            const messagesDiv = document.getElementById('messages');
            const loadingDiv = document.createElement('div');
            loadingDiv.id = 'loading';
            loadingDiv.className = 'message assistant';
            loadingDiv.innerHTML = `
                <div class="loading">
                    <div class="loading-dot"></div>
                    <div class="loading-dot"></div>
                    <div class="loading-dot"></div>
                </div>
            `;
            messagesDiv.appendChild(loadingDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function hideLoading() {
            const loadingDiv = document.getElementById('loading');
            if (loadingDiv) {
                loadingDiv.remove();
            }
        }

        function setInputEnabled(enabled) {
            document.getElementById('userInput').disabled = !enabled;
            document.getElementById('sendBtn').disabled = !enabled;
            document.querySelectorAll('.quick-btn').forEach(btn => {
                btn.disabled = !enabled;
            });
        }

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            
            if (!message || isLoading) return;

            if (API_KEY === 'YOUR_GOOGLE_GEMINI_API_KEY_HERE') {
                alert('è«‹å…ˆåœ¨ç¨‹å¼ç¢¼ä¸­è¨­å®šæ‚¨çš„ Google Gemini API Keyï¼');
                return;
            }

            isLoading = true;
            setInputEnabled(false);
            
            addMessage('user', message);
            input.value = '';
            
            showLoading();

            try {
                const messages = [
                    {
                        role: 'user',
                        parts: [{ text: systemPrompt }]
                    },
                    ...conversationHistory.map(msg => ({
                        role: msg.role === 'assistant' ? 'model' : 'user',
                        parts: [{ text: msg.content }]
                    }))
                ];

                const response = await fetch(`https://generativelanguage.googleapis.com/v1/models/gemini-2.5-flash:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: messages,
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 8791,
                        }
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    // Log the full error to the console for debugging
                    console.error('API HTTP Error:', response.status, errorData);
                    // Throw a specific error for the catch block to handle
                    throw new Error(`API HTTP Error ${response.status}: ${errorData.error.message || 'Unknown server error.'}`);
                }

                const data = await response.json();
                hideLoading();
                console.log('API Response:', data);

                if (data.candidates && data.candidates[0]?.content?.parts?.[0]?.text) {
                    addMessage('assistant', data.candidates[0].content.parts[0].text);
                } else {
                    throw new Error('Invalid response');
                }
            } catch (error) {
                console.error('Error:', error);
                hideLoading();
                addMessage('assistant', 'æŠ±æ­‰ï¼Œæˆ‘é‡åˆ°äº†ä¸€äº›å•é¡Œã€‚è«‹ç¨å¾Œå†è©¦ã€‚');
            } finally {
                isLoading = false;
                setInputEnabled(true);
                input.focus();
            }
        }

        function sendQuickMessage(message) {
            document.getElementById('userInput').value = message;
            sendMessage();
            
            // è‡ªå‹•æ”¶åˆ toggle list
            const quickGrid = document.getElementById('quickGrid');
            const toggleIcon = document.getElementById('toggleIcon');
            const quickButtons = document.querySelector('.quick-buttons');
            const chatArea = document.querySelector('.chat-area');
            
            quickGrid.classList.remove('expanded');
            toggleIcon.classList.remove('expanded');
            quickButtons.classList.add('collapsed');
            chatArea.classList.add('toggle-collapsed');
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function handleAction(action) {
            alert(`æ„Ÿè¬æ‚¨ï¼${action}`);
        }

        function toggleQuickButtons() {
            const quickGrid = document.getElementById('quickGrid');
            const toggleIcon = document.getElementById('toggleIcon');
            const quickButtons = document.querySelector('.quick-buttons');
            const chatArea = document.querySelector('.chat-area');
            
            quickGrid.classList.toggle('expanded');
            toggleIcon.classList.toggle('expanded');
            
            // ç®¡ç†æ”¶åˆç‹€æ…‹çš„é–“è·
            if (quickGrid.classList.contains('expanded')) {
                quickButtons.classList.remove('collapsed');
                chatArea.classList.remove('toggle-collapsed');
            } else {
                quickButtons.classList.add('collapsed');
                chatArea.classList.add('toggle-collapsed');
            }
        }

        // åˆå§‹åŒ–æ™‚èšç„¦è¼¸å…¥æ¡†
        document.getElementById('userInput').focus();
    </script>
</body>
</html>